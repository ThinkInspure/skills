# 核心技能详解

<cite>
**本文档引用的文件**   
- [README.md](file://README.md)
- [docx/SKILL.md](file://skills/docx/SKILL.md)
- [docx/docx-js.md](file://skills/docx/docx-js.md)
- [docx/ooxml.md](file://skills/docx/ooxml.md)
- [pdf/SKILL.md](file://skills/pdf/SKILL.md)
- [pdf/forms.md](file://skills/pdf/forms.md)
- [pdf/reference.md](file://skills/pdf/reference.md)
- [pptx/SKILL.md](file://skills/pptx/SKILL.md)
- [pptx/html2pptx.md](file://skills/pptx/html2pptx.md)
- [pptx/ooxml.md](file://skills/pptx/ooxml.md)
- [canvas-design/SKILL.md](file://skills/canvas-design/SKILL.md)
- [frontend-design/SKILL.md](file://skills/frontend-design/SKILL.md)
- [internal-comms/SKILL.md](file://skills/internal-comms/SKILL.md)
- [mcp-builder/SKILL.md](file://skills/mcp-builder/SKILL.md)
</cite>

## 目录
1. [文档处理技能](#文档处理技能)
2. [创意设计技能](#创意设计技能)
3. [开发与自动化技能](#开发与自动化技能)
4. [企业沟通技能](#企业沟通技能)
5. [技能协同工作](#技能协同工作)

## 文档处理技能

文档处理技能是Claude功能的核心，使Claude能够创建、编辑和分析专业文档。这些技能涵盖了DOCX、PDF和PPTX等主要文档格式，提供了从简单文本提取到复杂格式化和跟踪更改的全面功能。

### DOCX文档处理

DOCX技能提供了处理Word文档的完整工作流程，包括创建新文档、编辑现有文档以及进行文档审查。

**创建新文档**
当需要从头创建Word文档时，使用**docx-js**工作流。该工作流允许使用JavaScript/TypeScript创建Word文档。关键步骤包括：
- **强制阅读文档**：在开始创建文档之前，必须完整阅读`docx-js.md`文件，以了解详细的语法、关键的格式规则和最佳实践。
- **使用文档库**：利用`Document`、`Paragraph`、`TextRun`等组件来构建文档内容。
- **导出为DOCX**：使用`Packer.toBuffer()`将创建的文档导出为.docx文件。

**编辑现有文档**
当需要编辑现有Word文档时，使用**Document库**（一个用于OOXML操作的Python库）。该库自动处理基础设施设置，并提供文档操作的方法。工作流程包括：
- **强制阅读文档**：在开始编辑之前，必须完整阅读`ooxml.md`文件，以了解Document库的API和直接编辑文档文件的XML模式。
- **解包文档**：使用`python ooxml/scripts/unpack.py <office_file> <output_directory>`命令将文档解包。
- **运行Python脚本**：使用Document库创建和运行Python脚本来进行编辑。
- **重新打包文档**：使用`python ooxml/scripts/pack.py <input_directory> <office_file>`命令将编辑后的文档重新打包。

**文档审查工作流（跟踪更改）**
对于需要进行全面跟踪更改的文档审查，使用**跟踪更改工作流**。该工作流允许在实施到OOXML之前，使用Markdown计划综合的跟踪更改。关键原则包括：
- **最小化、精确的编辑**：在实施跟踪更改时，只标记实际更改的文本。重复未更改的文本会使编辑更难审查，并显得不专业。
- **分批策略**：将相关更改分组为3-10个更改的批次。这使得调试更易于管理，同时保持效率。在进行下一批之前测试每一批。
- **位置方法**：通过章节/标题编号、段落标识符、唯一周围文本的grep模式或文档结构来识别更改在XML中的位置。

**代码风格指南**
- 编写简洁的代码
- 避免冗长的变量名和冗余操作
- 避免不必要的print语句

**依赖项**
- **pandoc**：用于文本提取
- **docx**：用于创建新文档
- **LibreOffice**：用于PDF转换
- **Poppler**：用于将PDF转换为图像
- **defusedxml**：用于安全的XML解析

**Section sources**
- [docx/SKILL.md](file://skills/docx/SKILL.md#L1-L197)
- [docx/docx-js.md](file://skills/docx/docx-js.md#L1-L350)
- [docx/ooxml.md](file://skills/docx/ooxml.md#L1-L610)

### PDF文档处理

PDF技能提供了全面的PDF操作工具包，用于提取文本和表格、创建新PDF、合并/拆分文档以及处理表单。

**Python库**
- **pypdf**：用于基本操作，如合并、拆分、提取元数据和旋转页面。
- **pdfplumber**：用于带布局的文本提取和表格提取。
- **reportlab**：用于创建PDF，包括基本PDF创建和多页PDF创建。

**命令行工具**
- **pdftotext (poppler-utils)**：用于提取文本，支持保留布局和提取特定页面。
- **qpdf**：用于合并、拆分、旋转页面和移除密码。
- **pdftk**：如果可用，用于合并、拆分和旋转。

**常见任务**
- **从扫描的PDF中提取文本**：使用`pytesseract`和`pdf2image`进行OCR。
- **添加水印**：使用`pypdf`将水印应用到所有页面。
- **提取图像**：使用`pdfimages`提取所有嵌入的图像。
- **密码保护**：使用`pypdf`加密PDF。

**快速参考**
| 任务 | 最佳工具 | 命令/代码 |
|------|-----------|--------------|
| 合并PDF | pypdf | `writer.add_page(page)` |
| 拆分PDF | pypdf | 每个文件一页 |
| 提取文本 | pdfplumber | `page.extract_text()` |
| 提取表格 | pdfplumber | `page.extract_tables()` |
| 创建PDF | reportlab | Canvas或Platypus |
| 命令行合并 | qpdf | `qpdf --empty --pages ...` |
| OCR扫描的PDF | pytesseract | 先转换为图像 |
| 填充PDF表单 | pdf-lib或pypdf（见forms.md） | 见forms.md |

**Section sources**
- [pdf/SKILL.md](file://skills/pdf/SKILL.md#L1-L295)
- [pdf/reference.md](file://skills/pdf/reference.md#L1-L612)

### PPTX演示文稿处理

PPTX技能提供了创建、编辑和分析PowerPoint演示文稿的功能。

**创建新的PowerPoint演示文稿（无模板）**
当需要从头创建PowerPoint演示文稿时，使用**html2pptx**工作流将HTML幻灯片转换为PowerPoint，以实现准确的定位。

**设计原则**
- **内容驱动的设计方法**：在创建任何演示文稿之前，分析内容并选择适当的设计元素。
- **考虑主题**：这个演示文稿是关于什么的？它暗示了什么样的语气、行业或情绪？
- **检查品牌**：如果用户提到了公司/组织，请考虑他们的品牌颜色和身份。
- **匹配调色板与内容**：选择反映主题的颜色。
- **陈述你的方法**：在编写代码之前解释你的设计选择。

**要求**
- ✅ 在编写代码之前陈述你的内容驱动的设计方法
- ✅ 仅使用网络安全字体：Arial、Helvetica、Times New Roman、Georgia、Courier New、Verdana、Tahoma、Trebuchet MS、Impact
- ✅ 通过大小、粗细和颜色创建清晰的视觉层次
- ✅ 确保可读性：强烈的对比度、适当大小的文本、清晰的对齐
- ✅ 保持一致：在幻灯片之间重复使用模式、间距和视觉语言

**工作流**
- **强制阅读文档**：在开始创建演示文稿之前，必须完整阅读`html2pptx.md`文件，以了解详细的语法、关键的格式规则和最佳实践。
- **创建HTML文件**：为每张幻灯片创建一个HTML文件，具有适当的尺寸（例如，16:9的720pt × 405pt）。
- **创建并运行JavaScript文件**：使用`html2pptx.js`库将HTML幻灯片转换为PowerPoint并保存演示文稿。
- **视觉验证**：生成缩略图并检查布局问题。

**编辑现有的PowerPoint演示文稿**
当需要编辑现有的PowerPoint演示文稿时，需要使用原始的Office Open XML (OOXML)格式。这包括解包.pptx文件、编辑XML内容，然后重新打包。

**工作流**
- **强制阅读文档**：在开始任何演示文稿编辑之前，必须完整阅读`ooxml.md`文件，以了解OOXML结构和编辑工作流。
- **解包演示文稿**：`python ooxml/scripts/unpack.py <office_file> <output_dir>`
- **编辑XML文件**（主要是`ppt/slides/slide{N}.xml`和相关文件）
- **立即验证**：在每次编辑后立即验证，并在继续之前修复任何验证错误：`python ooxml/scripts/validate.py <dir> --original <file>`
- **重新打包演示文稿**：`python ooxml/scripts/pack.py <input_directory> <office_file>`

**创建新的PowerPoint演示文稿（使用模板）**
当需要创建遵循现有模板设计的演示文稿时，需要复制和重新排列模板幻灯片，然后替换占位符内容。

**工作流**
- **提取模板文本并创建视觉缩略图网格**
- **分析模板并保存库存到文件**
- **基于模板库存创建演示文稿大纲**
- **使用`rearrange.py`脚本复制、重新排序和删除幻灯片**
- **使用`inventory.py`脚本提取所有文本**
- **生成替换文本并保存数据到JSON文件**
- **使用`replace.py`脚本应用替换**

**依赖项**
- **markitdown**：用于从演示文稿中提取文本
- **pptxgenjs**：用于通过html2pptx创建演示文稿
- **playwright**：用于html2pptx中的HTML渲染
- **react-icons**：用于图标
- **sharp**：用于SVG光栅化和图像处理
- **LibreOffice**：用于PDF转换
- **Poppler**：用于将PDF转换为图像
- **defusedxml**：用于安全的XML解析

**Section sources**
- [pptx/SKILL.md](file://skills/pptx/SKILL.md#L1-L484)
- [pptx/html2pptx.md](file://skills/pptx/html2pptx.md#L1-L625)
- [pptx/ooxml.md](file://skills/pptx/ooxml.md#L1-L427)

### PDF表单处理

PDF表单处理技能提供了处理可填写和不可填写表单的详细步骤。

**可填写表单**
如果PDF具有可填写的表单字段：
- 运行`python scripts/check_fillable_fields <file.pdf>`检查表单字段。
- 运行`python scripts/extract_form_field_info.py <input.pdf> <field_info.json>`创建包含字段列表的JSON文件。
- 将PDF转换为PNG图像并分析图像以确定每个表单字段的用途。
- 创建`field_values.json`文件，其中包含要输入的每个字段的值。
- 运行`python scripts/fill_fillable_fields.py <input pdf> <field_values.json> <output pdf>`创建填写好的PDF。

**不可填写表单**
如果PDF没有可填写的表单字段，需要视觉上确定数据应添加的位置并创建文本注释。
- 将PDF转换为PNG图像并确定字段边界框。
- 创建包含字段信息和显示边界框的验证图像的JSON文件。
- 验证边界框。
- 使用边界框填写表单。

**Section sources**
- [pdf/forms.md](file://skills/pdf/forms.md#L1-L206)

## 创意设计技能

创意设计技能专注于创建视觉上引人注目的艺术和设计作品，强调美学、原创性和专业工艺。

### 画布设计

画布设计技能指导创建视觉哲学——美学运动，然后通过设计表达这些哲学。

**设计哲学创建**
- **创建视觉哲学**：创建一个美学世界观，通过形式、空间、颜色、构图、图像、图形、形状、图案来表达，文本作为视觉点缀。
- **命名运动**：用1-2个词命名运动，如“Brutalist Joy”、“Chromatic Silence”、“Metabolist Dreams”。
- **阐述哲学**：用4-6个段落表达哲学如何通过空间和形式、颜色和材料、规模和节奏、构图和平衡、视觉层次来体现。
- **关键指南**：避免冗余，强调工艺，为下一个版本留下创造空间。

**画布创建**
- **推断微妙的参考**：在创建画布之前，识别原始请求中的微妙概念线索。
- **表达哲学**：使用创建的设计哲学和以下说明来创作杰作，体现哲学的所有方面，具有专家级工艺。
- **文本作为上下文元素**：文本总是最小化和以视觉为主，但让上下文决定是微弱的标签还是大胆的排版手势。
- **最终步骤**：为了完善作品，避免添加更多图形；而是完善已创建的内容，使其更加清晰，完全尊重设计哲学和极简主义原则。

**Section sources**
- [canvas-design/SKILL.md](file://skills/canvas-design/SKILL.md#L1-L130)

### 前端设计

前端设计技能指导创建独特、生产级的前端界面，避免通用的“AI垃圾”美学。

**设计思维**
- **目的**：这个界面解决了什么问题？谁使用它？
- **语气**：选择一个极端：极简主义、极繁主义、复古未来主义、有机/自然、奢华/精致、俏皮/玩具般、编辑/杂志、粗野主义/原始、艺术装饰/几何、柔和/粉彩、工业/实用主义等。
- **约束**：技术要求（框架、性能、可访问性）。
- **差异化**：什么让它**难忘**？有什么是别人会记住的？

**前端美学指南**
- **排版**：选择美观、独特、有趣的字体。避免通用字体如Arial和Inter；选择能提升前端美学的字体；意想不到的、有特色的字体选择。将独特的显示字体与精致的正文字体配对。
- **颜色与主题**：坚持一致的美学。使用CSS变量保持一致性。主导颜色和尖锐的强调色优于胆怯、均匀分布的调色板。
- **运动**：为效果和微交互使用动画。优先考虑HTML的CSS-only解决方案。使用Motion库进行React（如果可用）。关注高影响力时刻：一个精心编排的页面加载，带有交错的显示（animation-delay），比零散的微交互更令人愉悦。使用滚动触发和悬停状态来制造惊喜。
- **空间构图**：意想不到的布局。不对称。重叠。对角流动。打破网格的元素。慷慨的负空间或受控的密度。
- **背景和视觉细节**：创造氛围和深度，而不是默认使用纯色。添加与整体美学相匹配的上下文效果和纹理。应用创意形式，如渐变网格、噪点纹理、几何图案、分层透明度、戏剧性阴影、装饰性边框、自定义光标和颗粒覆盖。

**Section sources**
- [frontend-design/SKILL.md](file://skills/frontend-design/SKILL.md#L1-L43)

## 开发与自动化技能

开发与自动化技能专注于创建和集成外部服务，使Claude能够与外部API和系统交互。

### MCP构建器

MCP构建器技能指导创建高质量的MCP（模型上下文协议）服务器，使LLM能够通过精心设计的工具与外部服务交互。

**过程**
- **深入研究和规划**：了解现代MCP设计、研究MCP协议文档、研究框架文档、规划实现。
- **实施**：设置项目结构、实施核心基础设施、实施工具。
- **审查和测试**：代码质量、构建和测试。
- **创建评估**：创建综合评估以测试MCP服务器的有效性。

**工具实施**
- **输入模式**：使用Zod（TypeScript）或Pydantic（Python），包括约束和清晰的描述，在字段描述中添加示例。
- **输出模式**：定义`outputSchema`（如果可能），在工具响应中使用`structuredContent`（TypeScript SDK功能）。
- **工具描述**：功能的简洁摘要、参数描述、返回类型模式。
- **实施**：I/O操作的异步/等待、适当的错误处理、在适用时支持分页、在使用现代SDK时返回文本内容和结构化数据。
- **注释**：`readOnlyHint`、`destructiveHint`、`idempotentHint`、`openWorldHint`。

**Section sources**
- [mcp-builder/SKILL.md](file://skills/mcp-builder/SKILL.md#L1-L237)

## 企业沟通技能

企业沟通技能提供了一套资源，帮助撰写各种内部沟通，使用公司喜欢的格式。

### 内部沟通

内部沟通技能用于撰写内部沟通，如状态报告、领导更新、3P更新、公司通讯、FAQ、事件报告、项目更新等。

**使用此技能**
- **识别沟通类型**：从请求中识别沟通类型。
- **加载适当的指南文件**：从`examples/`目录中加载适当的指南文件：
  - `examples/3p-updates.md` - 用于团队更新的进度/计划/问题
  - `examples/company-newsletter.md` - 用于公司范围的通讯
  - `examples/faq-answers.md` - 用于回答常见问题
  - `examples/general-comms.md` - 用于不明确匹配上述任何一项的任何内容
- **遵循特定说明**：遵循该文件中的具体说明，包括格式、语气和内容收集。

**关键词**
3P更新、公司通讯、公司通讯、每周更新、常见问题、常见问题、更新、内部沟通

**Section sources**
- [internal-comms/SKILL.md](file://skills/internal-comms/SKILL.md#L1-L33)

## 技能协同工作

这些技能协同工作，为Claude提供了强大的功能，使其能够处理从文档创建和编辑到创意设计、开发自动化和企业沟通的各种任务。文档处理技能是核心，使Claude能够与专业文档交互，而创意设计、开发与自动化和企业沟通技能则扩展了其能力，使其能够创建视觉上引人注目的设计、与外部服务集成并撰写有效的内部沟通。这些技能的结合使Claude成为一个多功能和强大的工具，能够处理复杂和多样化的任务。